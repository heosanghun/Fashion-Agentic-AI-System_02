# SIMS Fashion 학습 및 Try-On 갭 분석

## 1. 저장소 접근 결과

- **대상**: `https://github.com/heosanghun/SIMS_Fashion`
- **결과**: 404 Not Found (비공개 저장소이거나 URL/이름이 다를 수 있음).
- **로컬 저장 없이** GitHub API·웹 검색으로만 분석했으며, 공개된 자료와 일반적인 Try-On 패턴을 기준으로 정리함.

---

## 2. 사용자 요구 기능 정리 (공부·반영 대상)

### (1) 본인 얼굴만 넣어도 알아서 옷을 입힌 사진 출력

- **의미**: 얼굴(셀카/정면) 1장만 업로드해도, 시스템이 **전신/상반신 인물**을 만들고 그 위에 **옷을 입힌 합성 이미지**를 출력.
- **공개 자료상 동작 방식**:
  - **1단계**: 얼굴 사진 → AI가 **전신 디지털 아바타(또는 상반신)** 생성.  
    (예: Google Gemini 2.5 Flash 이미지 모델 “Nano Banana” 활용 사례에서 “셀카만으로 전신 아바타 생성” 언급.)
  - **2단계**: 생성된 인물 + 선택된 의류 → **가상 착용 합성**으로 “옷을 입은 나” 이미지 출력.
- **구현 포인트**:
  - **입력**: 얼굴 1장 (필요 시 의류 1장 또는 “기본/추천 옷”).
  - **프롬프트**: “이 얼굴 사진을 바탕으로 전신(또는 상반신)이 보이는 자연스러운 인물 사진을 한 장 생성해주세요” 같은 **이미지 편집/생성** 요청.
  - **모델**: 이미지 출력이 가능한 Gemini (예: `gemini-2.0-flash-exp-image-generation`, `gemini-2.5-flash-preview` 등)로 **이미지 1장 입력 + 텍스트 → 이미지 1장 출력**.
  - **이후**: 생성된 “전신/상반신 인물”을 기존 Try-On 파이프라인에 넣어 **의류 합성**하면 “얼굴만 넣어도 옷 입은 사진”이 완성됨.

### (2) Try-On에서 얼굴과 옷을 선택하면 알아서 입혀주는 기능

- **의미**: Try-On 화면에서 **얼굴(인물) 이미지**와 **옷(의류) 이미지**를 각각 선택하면, **별도 설명 없이** 그 조합으로 “입힌” 결과 이미지를 자동 생성.
- **공개 자료상 동작 방식**:
  - **입력**: 인물 이미지(전신/상반신/얼굴) 1장 + 의류 이미지 1장.
  - **처리**: “첫 번째 이미지의 옷을 두 번째 이미지의 인물에게 입혀서, 한 장의 자연스러운 합성 사진을 생성”하는 **프롬프트 + 2장 입력 → 이미지 1장 출력**.
  - **출력**: 인물이 해당 옷을 입은 것처럼 보이는 1장의 이미지.
- **구현 포인트**:
  - UI: “의류 선택” + “인물/얼굴 선택”이 명확히 구분되어 있고, 선택만 하면 **한 번에 Try-On 요청**이 나가도록 함.
  - 백엔드: **의류 경로 + 인물 경로**가 실행 계획에 반드시 포함되고, Gemini(또는 동일 키로 쓰는 이미지 생성 API)에 **두 이미지 + 고정/자연어 프롬프트**로 넘겨 **이미지 1장**을 받아서 그대로 “최종 렌더링 결과”로 표시.

---

## 3. 현재 프로젝트(Fashion-Agentic-AI-System_01)와의 차이·문제 인지

### 지금 우리가 하는 것

- **Try-On (얼굴 + 옷 선택 → 입혀주기)**  
  - **의류 1장 + 인물 1장**을 올리면 `gemini_tryon`에서 **Gemini 이미지 생성** 호출 (예: `gemini-2.0-flash-exp-image-generation`).  
  - 프롬프트: “첫 번째=의류, 두 번째=인물 → 인물이 의류를 입은 한 장의 자연스러운 합성 사진 생성.”  
  - 응답에 **이미지 파트**가 있으면 저장 후 “최종 렌더링 결과”로 표시.  
  - **인물 이미지가 API까지 전달되지 않으면** (`person_image_path` 없음) 합성 없이 **의류 이미지만** 복사해 표시.

즉, “**얼굴과 옷을 선택하면 알아서 입혀주는**” 부분은 **입력(의류+인물)이 둘 다 들어오는 경우**에 이미 시도하고 있음.  
갭은 **인물 이미지가 빠지는 경우**와 **“얼굴만 넣어도”** 플로우가 없다는 점.

### 갭 1: “본인 얼굴만 넣어도 옷 입은 사진”

- **현재**: “얼굴만” 올리면 인물은 있지만 **의류가 없음** → Try-On은 “의류가 없습니다” 등으로 막히거나, 별도 플로우 없음.
- **필요한 것**:
  - **얼굴 1장만** 들어온 경우를 감지하고,
  - 1단계: **얼굴 → 전신(또는 상반신) 인물 이미지** 1장 생성 (Gemini 이미지 생성 + 적절한 프롬프트),
  - 2단계: (선택) **기본/추천 의류**를 하나 정하거나, 사용자가 “이 옷 입혀줘”로 나중에 의류를 추가하면,  
    **생성된 인물 + 의류**로 기존 Try-On 합성 호출.
- **정리**: “얼굴만 넣어도”는 **전신(또는 상반신) 생성 단계**가 추가되어야 하고, 그 다음에 현재와 같은 “인물+의류 → 입혀주기”를 붙이면 됨.

### 갭 2: Try-On에서 “얼굴 + 옷 선택 → 자동 입히기”

- **현재**:  
  - UI에서 “입을 옷(의류)” / “내 사진(인물)” 두 종류 업로드 가능.  
  - 백엔드에서 `person_image_path`가 실행 계획에 넣어져야 Gemini에 두 장이 전달됨.  
  - **문제 인지**:  
    - 프론트에서 `person_image`를 폼으로 보내지 않거나,  
    - 백엔드/실행 계획에서 `person_image_path`를 빼먹으면  
    → **의류만 복사된 결과**가 나와 “개선이 없다”고 느껴짐.
- **필요한 것**:
  - **항상** 의류·인물 두 입력이 **같은 요청/실행 계획**에 포함되도록 보장.
  - “얼굴과 옷을 선택하면” → **추가 텍스트 없이** 한 번에 Try-On API 호출 (이미 “입혀줘” 등으로 가능하지만, UI에서 “선택만 하면 전송”이 명확할 것).

---

## 4. 정리: 우리가 “공부·반영”해야 할 것

| 목표 | 현재 상태 | 배운 점·필요 작업 |
|------|-----------|-------------------|
| **얼굴만 넣어도 옷 입은 사진** | 미구현 | ① 얼굴 1장 → 전신/상반신 인물 이미지 1장 생성 (Gemini 이미지 생성 + 프롬프트). ② 그 결과 + (기본/선택) 의류로 기존 Try-On 합성 호출. |
| **Try-On: 얼굴+옷 선택 → 입혀주기** | 구현 시도 중, 단 인물 미전달 시 실패 | ① 프론트: 의류·인물 항상 함께 전송. ② 백엔드: `person_image_path`를 실행 계획·컨텍스트에 반드시 포함. ③ “선택만 하면” 한 번에 Try-On 요청되도록 UX 정리. |

---

## 5. 다음 단계 제안 (코드 반영 시)

1. **얼굴만 업로드 플로우**  
   - 의도 판별: “이미지 1장(인물/얼굴)만 있고 의류 없음” → **전신/상반신 생성** 단계 추가.  
   - Gemini 이미지 생성: “이 얼굴 사진을 바탕으로 전신(또는 상반신)이 보이는 자연스러운 한 장의 사진을 생성해주세요” + `response_modalities=["Text","Image"]`.  
   - 생성된 이미지를 `person_image_path`로 쓰고, (기본 의류 또는 사용자 후속 선택)과 함께 기존 Try-On 호출.

2. **Try-On 신뢰성**  
   - API·실행 계획 로그에 `person_image_path` 유무 출력해, “얼굴+옷 선택”이 백엔드까지 들어오는지 항상 확인.  
   - 프론트: 의류·인물 둘 다 있을 때만 “입혀줘” 활성화 또는, “의류+인물 선택 후 Try-On” 버튼 하나로 명확히 고정.

이 문서는 **SIMS_Fashion 저장소 코드를 직접 보지 못한 상태**에서, 공개된 Try-On/이미지 생성 방식과 사용자 요구사항을 기준으로 정리한 “학습 요약 및 문제 인지”입니다.  
저장소가 나중에 공개되면, 실제 구현(프롬프트, 모델명, 2단계 조합 방식)을 이 문서에 맞춰 보완하면 됩니다.
