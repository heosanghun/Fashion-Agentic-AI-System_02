# 프롬프트 시나리오 가이드 — AI 가상 피팅

채팅창에 **어떤 문장을 입력하면 어떤 결과**가 나오는지 정리한 시나리오입니다.

---

## 0. 로컬 Try-On 전용 모드 (`TRY_ON_ONLY=1`)

`.env`에 **`TRY_ON_ONLY=1`** 이 있으면 **가상 피팅(Try-On)만** 실행됩니다.  
대화(OpenAI), 정보 검색(RAG), 의류 추천 분기는 사용하지 않고, 올린 이미지/텍스트는 모두 Try-On 파이프라인으로 처리됩니다. 의류+인물 두 장 올리고 "입혀줘"로 전송하면 됩니다.

---

## 1. Try-On (가상 피팅) — Gemini API 사용

**의도**: 옷/의류 이미지를 올리고 가상 피팅 실행

| 입력 방법 | 프롬프트 예시 | 결과 |
|-----------|----------------|------|
| **이미지 업로드 + 텍스트** | (이미지 첨부) + "이 옷 입혀줘" | Gemini Try-On 실행 → 가상 피팅 결과 이미지/분석 |
| **이미지 업로드 + 텍스트** | (이미지 첨부) + "가상 피팅 실행해줘" | 동일 |
| **이미지만** | (이미지만 첨부, 텍스트 없거나 짧게) | 이미지가 있으면 Try-On 파이프라인 진행 가능 |

**조건**:
- **Try-On 우선**: `.env`의 **`GEMINI_API_KEY`**로 Gemini 이미지 생성 Try-On을 먼저 시도합니다. (SIMS Fashion 등과 동일한 키 사용 가능.)
- **보조 합성**: Gemini에서 이미지가 나오지 않을 때만, `.env`에 **`FAL_KEY`**가 있으면 fal.ai Virtual Try-On으로 재시도합니다.
- 이미지는 채팅 입력창에서 **+** → 「입을 옷 사진 (의류)」「내 사진 (인물)」로 업로드.

---

## 2. 대화 (채팅) — OpenAI API 사용

**의도**: 일상 대화, 인사, 잡담

| 프롬프트 예시 | 결과 |
|---------------|------|
| 안녕 / 뭐해 / 반가워 | OpenAI로 짧은 대화 응답 |
| 나와 대화하자 / 잠깐 이야기해줘 | 동일 |

**조건**: `.env`에 `OpenAI_API_Key` 또는 `OPENAI_API_KEY` 설정 필요. 키가 없으면 고정 안내 문구만 표시.

---

## 3. 정보 검색 (RAG) — 도구 실행 없음

**의도**: 패션/의류/소재 관련 **설명·정의** 질문

| 프롬프트 예시 | 결과 |
|---------------|------|
| 오버사이즈란 뭐야? | RAG(로컬/외부) 검색 후 설명 텍스트 |
| 데님 알려줘 / 이 원단 뭐예요? | 동일 |
| ~이 뭐야? / 알려 주세요 / 설명해줘 | 정보성으로 분류 → RAG 응답 |

**조건**: 이미지 없이 위와 같은 표현일 때. Try-On은 실행되지 않고 RAG 검색 결과만 반환.

---

## 4. 의류 추천 — RAG + (선택) 도구

**의도**: "추천해줘", "찾아줘" 등

| 프롬프트 예시 | 결과 |
|---------------|------|
| 캐주얼 코디 추천해줘 | garment_recommendation 플로우 → RAG·상품 검색(Mock) |
| 청바지 찾아줘 | 동일 |

이미지를 함께 올리면 Try-On과 연계될 수 있음.

---

## 5. 가상 피팅 안내만 (실행 없음)

**의도**: "가상 피팅"이라고만 말하고 이미지는 안 올린 경우

| 프롬프트 예시 | 결과 |
|---------------|------|
| 가상 피팅이 뭐야? (이미지 없음) | Try-On 실행 없이, RAG/안내 문구로 응답 |
| 옷 입혀달라고 했을 때 (이미지 없음) | 동일 — "이미지를 올려주세요" 안내 등 |

**실제 Try-On 결과**를 보려면 **반드시 의류 이미지를 업로드**한 뒤 "입혀줘" / "가상 피팅 실행해줘" 등으로 요청.

---

## 요약 플로우

```
[입력: 텍스트 + 이미지 여부]
    ↓
[의도 분석]
  · "안녕" 등 대화 → OpenAI 채팅
  · "~란 뭐야" 등 정보 → RAG만
  · "추천/찾아줘" → 추천 플로우 (RAG + Mock 검색)
  · "입혀줘" / "가상 피팅" + 이미지 있음 → Try-On (Gemini)
    ↓
[결과: 채팅 메시지 / RAG 설명 / Try-On 이미지·분석]
```

---

## .env 설정 요약

| 변수명 | 용도 |
|--------|------|
| `GEMINI_API_KEY` | Try-On(가상 피팅) — Gemini API |
| `OpenAI_API_Key` 또는 `OPENAI_API_KEY` | 대화(채팅) — OpenAI API |

둘 다 설정 후 **API 서버 재시작** 필요.
